<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Emails List</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 700px; margin: 40px auto; }
    h1 { text-align: center; }
    ul { list-style-type: none; padding: 0; }
    li { margin: 10px 0; padding: 10px; border: 1px solid #ddd; border-radius: 5px; background-color: #f9f9f9;}
    .subject { font-weight: bold; font-size: 1.2em; color: #333; }
    .status { font-style: italic; color: #555; }
    .status.sent { color: green; font-weight: bold; }
    .status.draft { color: orange; }
    div { margin-top: 5px; font-size: 0.9em; color: #666; }
  </style>
</head>
<body>
  <%- include('partials/navbar') %>

  <h1>Emails</h1>
  <ul>
    <% if (emails && emails.length > 0) { %>
      <% emails.forEach(email => { %>
        <li>
          <div class="subject"><%= email.subject %></div>
          <div class="status <%= email.status.toLowerCase() %>">Status: <%= email.status %></div>
          <div>Created: <%= new Date(email.creation_date).toLocaleString() %></div>
          <% if (email.published_date) { %>
            <div>Published: <%= new Date(email.published_date).toLocaleString() %></div>
          <% } %>
        </li>
      <% }); %>
    <% } else { %>
      <li>No emails found.</li>
    <% } %>
  </ul>

  <script>
    // Pass server-side data to common.js for API selection
    window.availableApiAccounts = <%- JSON.stringify(apiKeys) %>;
    window.activeApiAccountName = '<%= activeApiName %>';
  </script>
  <script src="/js/common.js"></script>
</body>
</html>